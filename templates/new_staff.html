{% extends "base.html" %}
{% block content %}

<div class="p-8">

  <div class="flex justify-between items-center mb-8">
    <h1 class="text-4xl font-bold text-primary">New Staff Entry</h1>

    <a href="{{ url_for('routes.staff_details') }}"
       class="btn btn-outline btn-secondary text-lg flex items-center gap-2">
      ðŸ‘¥ View All Staff
    </a>
  </div>

  <div class="flex justify-center">
    <form method="POST" action="/staff/new"
          class="card w-full max-w-2xl bg-base-100 shadow-2xl border border-base-300 p-8 rounded-xl space-y-6">

      <!-- Staff ID -->
      <div class="form-control">
        <label class="label"><span class="label-text">Staff ID</span></label>
        <input type="text" name="staff_id" value="{{ next_staff_id }}" readonly
               class="input input-bordered w-full bg-base-200 cursor-not-allowed">
      </div>

      <!-- Name -->
      <div class="form-control">
        <label class="label"><span class="label-text">Full Name</span></label>
        <input type="text" name="name" class="input input-bordered w-full" required>
      </div>

      <!-- Category -->
      <div class="form-control">
        <label class="label"><span class="label-text">Category</span></label>
        <select name="category" id="categorySelect"
                class="select select-bordered w-full" required>
          <option disabled selected>Select Category</option>
          <option value="Admin">Admin</option>
          <option value="Teaching">Teaching</option>
          <option value="Non-Teaching">Non-Teaching</option>
          <option value="House-Keeping">House-Keeping</option>
          <option value="Driver">Driver</option>
        </select>
      </div>

      <!-- Department (hidden by default) -->
      <div class="form-control hidden" id="departmentField">
        <label class="label"><span class="label-text">Department</span></label>
        <input type="text" name="department"
               class="input input-bordered w-full">
      </div>

      <!-- Date Joined -->
      <div class="form-control">
        <label class="label"><span class="label-text">Date of Joining</span></label>
        <input type="date" name="date_joined" class="input input-bordered w-full" required>
      </div>

      <!-- Designation -->
      <div class="form-control">
        <label class="label"><span class="label-text">Designation</span></label>
        <input type="text" name="designation"
               class="input input-bordered w-full" required>
      </div>

      <!-- Base Salary -->
      <div class="form-control">
        <label class="label"><span class="label-text">Base Salary (â‚¹)</span></label>
        <input type="number" name="base_salary" min="0"
               class="input input-bordered w-full" required>
      </div>

      <!-- EPF Eligible? -->
      <div class="form-control">
        <label class="label"><span class="label-text">Eligible for EPF?</span></label>
        <select name="epf_eligible" id="epfEligible"
                class="select select-bordered w-full" required>
          <option value="No" selected>No</option>
          <option value="Yes">Yes</option>
        </select>
      </div>

      <!-- PF Number (hidden unless EPF = Yes) -->
      <div class="form-control hidden" id="pfField">
        <label class="label"><span class="label-text">PF Number</span></label>
        <input type="text" name="pf_number"
               class="input input-bordered w-full" placeholder="Enter PF Number">
      </div>

      <!-- ESI Number (unchanged) -->
      <div class="form-control">
        <label class="label"><span class="label-text">ESI Number (optional)</span></label>
        <input type="text" name="esi_number"
               class="input input-bordered w-full">
      </div>

      <!-- Bank Account -->
      <div class="form-control">
        <label class="label"><span class="label-text">Bank Account Number</span></label>
        <input type="text" name="bank_account"
               class="input input-bordered w-full" required>
      </div>

      <!-- Aadhar -->
      <div class="form-control">
        <label class="label"><span class="label-text">Aadhar Number</span></label>
        <input type="text" name="aadhar" minlength="12" maxlength="12"
               class="input input-bordered w-full" required>
      </div>

      <div class="form-control mt-6">
        <button type="submit" class="btn btn-primary w-full text-lg">Add Staff</button>
      </div>

    </form>
  </div>
</div>

<script>
/* ----------------------------
   CATEGORY â†’ DEPARTMENT LOGIC
-----------------------------*/
const categorySelect = document.getElementById("categorySelect");
const departmentField = document.getElementById("departmentField");

categorySelect.addEventListener("change", () => {
    if (categorySelect.value === "Teaching") {
        departmentField.classList.remove("hidden");
    } else {
        departmentField.classList.add("hidden");
    }
});

/* ----------------------------
   EPF ELIGIBLE? â†’ PF FIELD
-----------------------------*/
const epfSelect = document.getElementById("epfEligible");
const pfField = document.getElementById("pfField");

epfSelect.addEventListener("change", () => {
    if (epfSelect.value === "Yes") {
        pfField.classList.remove("hidden");
    } else {
        pfField.classList.add("hidden");
    }
});
</script>

{% endblock %}
